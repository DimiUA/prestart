<template>
<!-- Page, data-name contains page name which can be used in callbacks -->
    <div class="page " > <!-- page-with-subnavbar -->
    <!-- Top Navbar -->
        <div class="navbar">
            <div class="navbar-inner">
                <div class="left">
                    <a href="#" class="link back">
                        <i class="icon icon-back"></i>
                        <span class="ios-only">{{@global.LANGUAGE.COM_MSG00}}</span>
                    </a>
                </div>
                <div class="title sliding">{{@global.LANGUAGE.MENU_MSG01}}</div>
                <div class="right">
                    <a href="#" class="link playback-header-controls hide" >                
                        <i class="icon-header-play "></i>
                        <!-- <i class="icon-header-stop "></i> -->
                    </a>
                </div>
            </div>
        </div>

        <div class="toolbar tabbar tabbar-custom">
            <div class="toolbar-inner">              
              <a href="#trip-info" class="tab-link tab-link-active">{{@global.LANGUAGE.TRIPS_MSG06}}</a>
              <a href="#trip-playback" class="tab-link">{{@global.LANGUAGE.TRIPS_MSG07}}</a>              
            </div>
        </div>
        
        <div class="tabs-animated-wrap">
            <div class="tabs">
                <div class="page-content tab tab-active" id="trip-info">
                    {{#Gauge}}
                    <div class="gauge-raiting text-align-center"> 
                        <div class="gauge gauge-init"
                            data-type= 'semicircle' 
                            data-value= '{{Value}}'
                            data-border-bg-color= '#8e8e93'
                            data-border-color= '{{BorderColor}}'
                            data-value-text= '{{Raiting}}'
                            data-value-text-color= '#fff'
                            data-label-text= 'of 10 points'
                            data-label-text-color= '#8e8e93'
                        ></div> 
                    </div>
                    {{/Gauge}}
                    <div class="block-title block-title-custom margin-top">{{@global.LANGUAGE.TRIPS_MSG00}}</div> 
                    <div class="block block-starts text-align-center {{TripStat.Stars.Color}}">
                       <!--  *Raiting*        -->               
                           {{TripStat.Stars.Template}}
                    </div>             
                    <div class="list">
                        <ul>
                            {{#TripStat}}
                            <li>
                                <div class="item-content"> 
                                    <div class="item-media text-color-gray">
                                        <i class="f7-icons icon-trip-distance "></i>
                                    </div>                      
                                    <div class="item-inner">
                                        <div class="item-title">
                                            <div class="item-header item-label">{{@global.LANGUAGE.TRIPS_MSG01}}</div>
                                            {{Distance}}
                                        </div>                                
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="item-content"> 
                                    <div class="item-media text-color-gray">
                                        <i class="f7-icons icon-trip-time "></i>
                                    </div>                      
                                    <div class="item-inner">
                                        <div class="item-title">
                                            <div class="item-header item-label">{{@global.LANGUAGE.TRIPS_MSG02}}</div>
                                            {{Time}}
                                        </div>                                
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="item-content"> 
                                    <div class="item-media text-color-gray">
                                        <i class="f7-icons icon-trip-speed "></i>
                                    </div>                      
                                    <div class="item-inner">
                                        <div class="item-title">
                                            <div class="item-header item-label">{{@global.LANGUAGE.TRIPS_MSG03}}</div>
                                            {{MaxSpeed}}
                                        </div>                                
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="item-content"> 
                                    <div class="item-media text-color-gray">
                                        <!-- <i class="f7-icons icon-trip-speed "></i> -->
                                    </div>                      
                                    <div class="item-inner">
                                        <div class="item-title">
                                            <div class="item-header item-label">{{@global.LANGUAGE.TRIPS_MSG04}}</div>
                                            {{AvargeSpeed}}
                                        </div>                                
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="item-content"> 
                                    <div class="item-media text-color-gray">
                                        <i class="f7-icons icon-trip-fuel "></i>
                                    </div>                      
                                    <div class="item-inner">
                                        <div class="item-title">
                                            <div class="item-header item-label">{{@global.LANGUAGE.TRIPS_MSG05}}</div>
                                            {{FuelUsed}}
                                        </div>                                
                                    </div>
                                </div>
                            </li>
                            {{/TripStat}}
                        </ul>
                    </div>
                </div>

                <div class="page-content tab" id="trip-playback">
                    <div class="map-wrapper">
                        <div id="map"></div>
                    </div>
                    <div class="bottom-info padding-top ">
                        <div class="block margin-0">
                            <div class="range-slider range-slider-init"
                                data-min="1"
                                data-max="100"
                                data-step="1"                            
                                data-value="1"
                              ></div>
                        </div>                    
                        <div class="list no-hairlines no-hairlines-between margin-0">                       
                            <ul class="display-flex justify-content-space-between" >
                                {{#Playback}}
                                <li>
                                    <div class="item-content">                                                       
                                        <div class="item-inner">
                                            <div class="item-title">
                                                <div class="item-header item-label">{{@global.LANGUAGE.TRIPS_MSG08}}</div>
                                                {{Start}}
                                            </div>                                
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item-content">                                                       
                                        <div class="item-inner">
                                            <div class="item-title text-align-right">
                                                <div class="item-header item-label">{{@global.LANGUAGE.TRIPS_MSG09}}</div>
                                                {{Finish}}
                                            </div>                                
                                        </div>
                                    </div>
                                </li>
                                {{/Playback}}
                            </ul>
                        </div>

                        <div class="block margin-0">
                            <div class="range-slider range-slider-init"
                                data-min="1"
                                data-max="100"
                                data-step="1"                            
                                data-value="1"
                              ></div>
                        </div>
                        <div class="list no-hairlines no-hairlines-between margin-0">                       
                            <ul class="display-flex justify-content-space-between" >                            
                                <li>
                                    <div class="item-content">                                                       
                                        <div class="item-inner">
                                            <div class="item-title">                                           
                                                {{@global.LANGUAGE.TRIPS_MSG10}}
                                            </div>                                
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item-content">                                                       
                                        <div class="item-inner">
                                            <div class="item-title">                                           
                                                {{@global.LANGUAGE.TRIPS_MSG11}}
                                            </div>                                
                                        </div>
                                    </div>
                                </li>                           
                            </ul>
                           
                        </div>                    
                    </div>
                </div>


            </div>
        </div>
        
   
        

            
    </div>


        
</template>


<script>
  // script must return component object
    return { 
        data: function () {
            var ret = {
                TripStat: {
                    Raiting: '8',
                    Stars: {
                        Value: 0,
                        Template: '',
                        Color: '',
                    },                    
                    Distance: 1200,
                    Time: '8:56:23',
                    MaxSpeed: '121 km/h',
                    AvargeSpeed: '87 km/h',
                    FuelUsed: '70 L',
                },
                Playback: {
                    Start: '09.01.2018 1:34 PM ',
                    Finish: '09.01.2018 4:54 PM',
                },
                Gauge: {
                    Value: 0,
                    BorderColor: '#BC2132',
                    Raiting: 0,
                }
            };  

            
            
            switch(true) {
                case ( ret.TripStat.Raiting >= 9 ):
                    ret.TripStat.Stars.Value = 5;
                    ret.TripStat.Stars.Color = 'text-color-green';
                    break;

                case ( ret.TripStat.Raiting >= 7 ):
                    ret.TripStat.Stars.Value = 4;
                    ret.TripStat.Stars.Color = 'text-color-green';
                    break;

                case ( ret.TripStat.Raiting >= 5 ):
                    ret.TripStat.Stars.Value = 3;
                    ret.TripStat.Stars.Color = 'text-color-orange';
                    break;

                case ( ret.TripStat.Raiting >= 3 ):
                    ret.TripStat.Stars.Value = 2;
                    ret.TripStat.Stars.Color = 'text-color-red';
                    break;

                default:
                    ret.TripStat.Stars.Value = 1;
                    ret.TripStat.Stars.Color = 'text-color-red';
            } 
            for (var i = ret.TripStat.Stars.Value; i >= 1; i--) {
                ret.TripStat.Stars.Template += '<i class="f7-icons icon-trip-star"></i>';
            }
                
            ret.Gauge.Raiting = ret.TripStat.Raiting;
            ret.Gauge.Value = ret.TripStat.Raiting / 10;
            switch(true) {
                case ( ret.TripStat.Raiting >= 8 ):
                    ret.Gauge.BorderColor = '#39B54A';
                    break;

                case ( ret.TripStat.Raiting >= 5 ):
                    ret.Gauge.BorderColor = '#F7931E';
                    break;
            } 

            return ret;
        },

        methods: { 
            
        },

        on: {
            pageInit: function (e, page) { 
                var self = this; 
                var MapTrack;
                var playbackHeaderControls = page.$pageEl.find('.playback-header-controls');
                                

                var latlng = [50.449354, 30.523110];
                MapTrack = self.$app.methods.createMap({ target: 'map', latLng: latlng, zoom: 15 });   
                //window.PosMarker[asset].addTo(MapTrack);
                
                page.$pageEl.on('tab:show', function(e){ 
                    if (e.target.id == 'trip-playback') {
                        $$(playbackHeaderControls).removeClass('hide');
                    }else{
                        $$(playbackHeaderControls).addClass('hide');
                    }
                });

                /*if (self.TripStat.Raiting >= 8 ) {

                }else if(self.TripStat.Raiting >= 5){

                }else{

                }*/
                /*var gaugeBorderColor = '#BC2132';
                switch(true) {
                    case ( self.TripStat.Raiting >= 8 ):
                        gaugeBorderColor = '#39B54A';
                        break;

                    case ( self.TripStat.Raiting >= 5 ):
                        gaugeBorderColor = '#F7931E';
                        break;
                }               

                var gauge = app.gauge.create({
                    el: '.gauge-raiting .gauge',
                    type: 'semicircle', 
                    value:  self.TripStat.Raiting / 10,
                    borderBgColor: '#8e8e93',
                    borderColor: '#F7931E',
                    valueText: self.TripStat.Raiting,
                    valueTextColor: '#fff',
                    labelText: 'of 10 points',
                    labelTextColor: '#8e8e93',
                    on: {
                        beforeDestroy: function () {
                          console.log('Gauge will be destroyed');
                        }
                    }
                });*/
            },   
        }
    };
</script>
    